#!/bin/bash

# Define custom base alphabets
water_base="ewatr"
stir_base="ti.r"
bestchol_base="beshtclo"

# Function to convert from custom base to decimal
convert_to_decimal() {
  local num="$1"
  local base_chars="$2"
  local base=${#base_chars}
  local len=${#num}
  local i digit value=0

  for (( i=0; i<len; i++ )); do
    digit="${num:$i:1}"
    pos=$(expr index "$base_chars" "$digit")
    if [ "$pos" -eq 0 ]; then
      echo "Invalid character '$digit' for base '$base_chars'" >&2
      exit 1
    fi
    value=$(( value * base + pos - 1 ))
  done
  echo "$value"
}

# Function to convert decimal to custom base
convert_from_decimal() {
  local num="$1"
  local base_chars="$2"
  local base=${#base_chars}
  local result=""

  if [ "$num" -eq 0 ]; then
    echo "${base_chars:0:1}"
    return
  fi

  while [ "$num" -gt 0 ]; do
    digit=$(( num % base ))
    result="${base_chars:$digit:1}$result"
    num=$(( num / base ))
  done

  echo "$result"
}

# Get environment variables
water_val="$WATER"
stir_val="$STIR"

# Convert both to decimal
dec1=$(convert_to_decimal "$water_val" "$water_base")
dec2=$(convert_to_decimal "$stir_val" "$stir_base")

# Add the numbers
sum=$(( dec1 + dec2 ))

# Convert to bestchol base and print
convert_from_decimal "$sum" "$bestchol_base"
